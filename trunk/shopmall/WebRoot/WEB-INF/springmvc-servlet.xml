<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
	<import resource="classpath:/config/spring/mvc/*.xml" />
	<!-- 
		<import resource="classpath:/config/spring/mvc/admin.xml"/>
	-->
	<!-- 
		工作流配置
		<import resource="classpath:/config/spring/mvc/workflow-api.xml"/>
		<import resource="classpath:/config/spring/mvc/workflow-setup.xml"/>
	-->
	<bean id="methodNameResolver"
		class="org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver">
		<property name="paramName" value="method" />
		<property name="defaultMethodName" value="index" /><!-- 默认方法 -->
	</bean>

	<bean id="multipartResolver"
		class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
		<property name="maxUploadSize" value="10485760" />
	</bean>


	<bean id="fmHtmlEscape"
		class="freemarker.template.utility.HtmlEscape" />

	<bean id="freemarkerConfigurer"
		class="org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer">
		<property name="templateLoaderPath">
			<value>/WEB-INF/template/</value>
		</property>
		<property name="freemarkerSettings"><!-- 如果模板不经常更新，此属性设置更新延迟时间 -->
			<props>
				<prop key="template_update_delay">0</prop>
				<prop key="default_encoding">UTF-8</prop>
			</props>
		</property>
		<property name="freemarkerVariables">
			<map>
				<entry key="html_escape" value-ref="fmHtmlEscape" />
			</map>
		</property>
	</bean>

	<bean id="jspViewResolver"
		class="org.springframework.web.servlet.view.UrlBasedViewResolver">
		<property name="order" value="0" />
		<property name="viewClass"
			value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="" />
		<property name="suffix" value=".jsp" />
	</bean>

	<bean id="ftlViewResolver"
		class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver">
		<property name="order" value="1" />
		<property name="suffix">
			<value>.ftl</value>
		</property>
		<property name="viewClass">
			<value>
				org.springframework.web.servlet.view.freemarker.FreeMarkerView
			</value>
		</property>
	</bean>

	<bean id="exceptionResolver"
		class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
		<property name="defaultErrorView" value="/errors/default" />
		<property name="exceptionMappings">
			<props>
				<prop key="com.jcrm.exception.AlertException">
					/errors/alert
				</prop>
				<prop key="com.jcrm.exception.ParameterException">
					/errors/parameter
				</prop>
			</props>
		</property>
	</bean>
</beans>